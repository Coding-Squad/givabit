<!DOCTYPE html>
<html>
<head>
  <title>action_test.html</title>
  <script src="../lib/misc/closure-library/closure/goog/base.js"></script>
  <script type="text/javascript">
    goog.require('goog.testing.jsunit');
  </script>
  <style type="text/css">
    .slider-container {
      width: 200px;
      height: 60px;
      left: 200px;
      position: absolute;
    }

    .slider-track {
      background: blue;
      width: 200px;
      height: 4px;
      position: relative;
      top: 28px;
    }

    .slider-dragger {
      border: 2px solid yellow;
      z-index: 2;
      height: 100%;
      width: 0px;
      z-index: 2;
      left: 0px;
      position: relative;
    }
  </style>
</head>
<body>
  <br /><br />
  <div class="slider-container">
    <div class="slider-track"></div>
    <div class="slider-dragger"></div>
  </div>
  <script type="text/javascript">
    getEffectiveStyle = function(element, property) {
      var doc = element.ownerDocument;
      if (doc.defaultView && doc.defaultView.getComputedStyle) {
        var styles = doc.defaultView.getComputedStyle(element, null);
        if (styles) {
          return styles[property] || styles.getPropertyValue(property) || '';
        }
      }

      return '';
    };

    function Slider(root) {
      var sliderDragger = root.getElementsByClassName('slider-dragger')[0];
      var pressed = false;
      var screenX = 0;
      var left = 0;
      var maxRight = parseInt(getEffectiveStyle(root, 'width'));

      this.mousedown = function(e) {
        pressed = true;
        screenX = e.screenX;
        left = parseInt(sliderDragger.style.left) || 0;
      }

      this.drag = function(e) {
        console.log('x');
        if (e.which == 1) {
          var currentLeft = sliderDragger.style.left || '0px';
          var currentLeftPx = parseInt(currentLeft);
          var setting = left + e.screenX - screenX;
          console.log('setting: ' + setting);
          if (setting >= 0 && setting < maxRight) {
            sliderDragger.style.left = setting + 'px';
          }
        }
      }

      this.init = function() {
        sliderDragger.addEventListener('mousedown', this.mousedown, false);
        root.addEventListener('mousedown', this.mousedown, false);
        root.addEventListener('mousemove', this.drag, false);
        sliderDragger.addEventListener('mousemove', this.drag, false);
        sliderDragger.addEventListener('mouseout', this.drag, false);
        sliderDragger.addEventListener('mouseup', this.mouseup, false);
      }
    }

    var sliderDragger = document.getElementsByClassName('slider-container')[0];
    new Slider(sliderDragger).init();
    function testPasses() {
    }

    function testFails() {
      assertTrue(false);
    }
  </script>
  <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
</body>
</html>
